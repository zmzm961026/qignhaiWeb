<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>青海师范大学物电学院</title>
    <link href="css/css.css" rel="stylesheet" />
    <link href="css/index.css" rel="stylesheet" />
    <link href="css/toPage.css" rel="stylesheet" />
</head>
<body>
    <div id="login">
        <div id="admin" class="login">
            <button class="close"></button>
            <div>您未被授权，请联系管理员&nbsp;:010-57524077</div>
            <div class="user" style="margin-top:0;">
                <input class="admin" type="text" autocomplete="off" value="" placeholder="请输入账号" />
            </div>
            <div class="password">
                <input class="admin_pass" type="password" autocomplete="off" value="" placeholder="请输入密码" />
            </div>
            <div class="login_button">
                <button id="admin_but">登录</button>
            </div>
        </div>
        <div id="log" class="login">
            <button class="close"></button>
            <div class="user">
                <input class="username" type="text" autocomplete="off" value="" placeholder="请输入用户名" />
            </div>
            <div class="password">
                <input class="password_log" type="password" autocomplete="off" value="" placeholder="请输入密码" />
            </div>
            <div class="zhuce">
                <a id="registe" href="javascript:;">注册</a><label id="forget_pass">忘记密码</label>
            </div>
            <div class="login_button">
                <button id="login_but" type="button">登录</button>
            </div>
        </div>
        <div id="zhuce" class="zhuce_user">
            <button class="close"></button>
            <div id="visited" class="teach_visited">
                <div class="xuehao">
                    <p>用&nbsp;&nbsp;户&nbsp;&nbsp;名</p>
                    <input class="sjh" type="text" autocomplete="off" placeholder="请输入用户名" value="" name="phone" />
                    <b></b>
                </div>
                <div class="xuehao">
                    <p>密<span>码</span></p>
                    <input id="ipu" type="password" autocomplete="off" placeholder="请输入密码" value="" name="password" />
                    <b></b>
                </div>
                <div class="xuehao">
                    <p style="letter-spacing:2.2px;">确认密码</p>
                    <input id="ipu1" type="password" autocomplete="off" placeholder="请再次输入密码" value="" />
                    <b></b>
                </div>
                <div class="xuehao sex">
                    <p></p>
                    <label><input name="teach" type="radio" class="tui-checkbox" value="" checked />老师</label>
                    <label><input name="teach" type="radio" class="tui-checkbox" value="" />学生</label>
                    <b></b>
                </div>
                <div class="xuehao form-group">
                    <p></p>
                    <div class="field">
                        <input type="text" class="input 
                        "  id="input1" name="code" placeholder="填写下方的验证码" data-validate="required:请填写下方的验证码"/>
                        <h4 type="button" id="checkCode" class="code" style="width:100px" value="createCode()"></h4>
                        <span href="#" onClick="createCode()">看不清楚</span>
                    </div>
                    <b></b>
                </div>
                <script>
                    createCode();
                        var code ; //在全局 定义验证码
                        function createCode(){ 
                            code = new Array();
                            var codeLength = 4;//验证码的长度
                            var checkCode = document.getElementById("checkCode");
                            checkCode.innerHTML = "";

                            var selectChar = new Array(2,3,4,5,6,7,8,9,'A','B','C','D','E','F','G','H','J','K','L','M','N','P','Q','R','S','T','U','V','W','X','Y','Z');

                            for(var i=0;i<codeLength;i++) {
                            var charIndex = Math.floor(Math.random()*32);
                                code +=selectChar[charIndex];
                            }
                            if(code.length != codeLength){
                                createCode();
                            }
                            checkCode.innerHTML = code;
                        }
                </script>
                <div class="login_button" style="height:70px;">
                    <button id="but">注册</button>
                </div>
                <div class="xuehao">
                    <p></p>
                    <span id="zhuce_dl">已有账号？去登录</span>
                </div>
            </div>
        </div>
        <div id="pass_change" class="pass_change">
            <button class="close"></button>
            <h3>重置密码</h3>
            <div>
                <div class="xuehao">
                    <p>手&nbsp;&nbsp;机&nbsp;&nbsp;号</p>
                    <input class="c_sjh" type="text" autocomplete="off" placeholder="请输入手机号" value="" />
                    <b></b>
                </div>
                <div class="xuehao">
                    <p>密<span>码</span></p>
                    <input id="c_ipu" type="password" autocomplete="off" placeholder="请输入密码" value="" />
                    <b></b>
                </div>
                <div class="xuehao">
                    <p style="letter-spacing:2.2px;">确认密码</p>
                    <input id="c_ipu1" type="password" autocomplete="off" placeholder="请再次输入密码" value="" />
                    <b></b>
                </div>
                <div class="login_button" style="height:80px;">
                    <button id="but_tj">提交</button>
                </div>
                <div class="xuehao">
                    <p></p>
                    <span id="forget_dl">记起了密码？去登录</span>
                </div>
                <div class="xuehao">
                    <p></p>
                    <span id="forget_zc">无账号？去注册</span>
                </div>
            </div>
        </div>
    </div>
    <div id="piao_xq">
        <div id="xq_div" class="piao_xq">
            <button id="close"></button>
            <div>
                <h3 id="title">通知</h3>
                <h5 id="date">时间</h5>
            </div>
            <div class="main_conDiv" id="content">
            </div>
        </div>
    </div>
    <div class="logo">
        <div class="logo1">
            <img src="images/logo.png"/>
            <div>
                <div>
                    <a id="login_btn">登录</a>   
                    <p href="">|</p> 
                    <a id="pass_btn">注册</a>
                </div>
                <div>
                    <a href="http://www.qhnu.edu.cn/" target="_blank" title="">学校首页</a>
                    <p href="">|</p>
                    <a href="https://wlx.qhnu.edu.cn/" target="_blank" title="">学院首页</a>
                </div>
            </div>
        </div>
    </div>
    <nav>
        <ul>
            <li class="hover"><a title="新能源资讯" href="index.html">新能源资讯</a></li>
            <li><a title="基础课程" href="Basic_course.html">基础课程</a></li>
            <li><a title="工程参考资料" href="Engineer.html">工程参考资料</a></li>
            <li><a title="创新创意视频" href="Creative.html">创新创意视频</a></li>
            <li><a title="创业展示" href="Entrepreneurship.html">创业展示</a></li>
            <li><a title="课程管理" id="htguanli" href="javascript:;">课程管理</a></li>
        </ul>
    </nav>
    <div class="con">
        <div class="informBoxd">   
            <div class="dynamicb"><h2>学院新闻</h2></div>
            <div class="infor_lista">
                <ul class="dynamic_list" id="news"></ul>
            </div>
        </div>
        <div class="informBoxd">
            <div class="dynamicb"><h2>学院通知</h2></div>
            <div class="infor_lista">
                <ul class="dynamic_list" id="notice"></ul>
            </div>
        </div>
    </div>
    <footer>青海师范大学物电学院</footer>
    <script src="js/jquery.js"></script>
    <script src="js/js.js"></script>
    <script>
        function tab(id){return document.getElementById(id)}
        $.ajax({
            url: 'http://192.168.1.167:325/api/Cour/Tongzhi',
            type: "GET",
            async: true,
            crossDomain:true,
            dataType: "json",
            success: function (data) {
                var notice_html='';
                var notice_title=[];
                var notice_conDate=[];
                var notice_index = Object.keys(data)[0];
                // 通知列表
                $.each(data[notice_index], function (index, value) {
                    notice_html += '<li id="notice_'+value.id+'"><em>' + value.title + '</em><span>' + value.conDate.split('-')[2] + '\/' + value.conDate.split('-')[1] + '</span></li>';
                    notice_title.push(value.title);
                    notice_conDate.push(value.conDate);
                })
                tab('notice').innerHTML=notice_html;
                abc('notice',notice_title,notice_conDate)
                //新闻列表
                var news_html='';
                var news_title=[];
                var news_conDate=[];
                var news_index = Object.keys(data)[1];
                $.each(data[news_index], function (index, value) {
                    news_html += '<li id="news_'+value.id+'"><em>' + value.title + '</em><span>' + value.date.split('-')[2] + '\/' + value.date.split('-')[1] + '</span></li>';
                    news_title.push(value.title);
                    news_conDate.push(value.date.split('T')[0]);
                })
                tab('news').innerHTML=news_html;
                abc('news',news_title,news_conDate)
            },
            error: function () {
            }
        })
        function abc(div,title,conDate,content){
            var aLi=tab(div).getElementsByTagName('li');
            for (var i = 0; i < aLi.length; i++) {
                aLi[i].index = i;
                aLi[i].onclick = function () {
                    tab('title').innerHTML=title[this.index];
                    tab('date').innerHTML=conDate[this.index];
                    var lID=aLi[this.index].getAttribute('id').split('_')[1];
                    var api;
                    if(aLi[this.index].getAttribute('id').split('_')[0]=='notice'){
                        api='/api/Cour/Tongzhixi'
                    }else{
                        api='/api/Cour/Detail'
                    }
                    //弹窗详情、获取数据
                    tab('piao_xq').style.display = 'block';
                    var xq_Div = document.getElementById('xq_div');
                    onresize = function () {
                        xq_Div.style.marginLeft = -xq_Div.offsetWidth / 2 + 'px';
                        xq_Div.style.marginTop = -xq_Div.offsetHeight / 2 + 'px';
                    }
                    xq_Div.style.marginLeft = -xq_Div.offsetWidth / 2 + 'px';
                    xq_Div.style.marginTop = -xq_Div.offsetHeight / 2 + 'px';
                    xq_ajax(lID,api)
                    tab('close').onclick = function () {
                        tab('piao_xq').style.display = 'none';
                    }
                }
            }
        }
        function xq_ajax(id,api){
            $.ajax({
                url: 'http://192.168.1.167:325'+api+'?id='+id,
                type: "GET",
                async: true,
                crossDomain:true,
                dataType: "json",
                success: function (data) {
                    var content_html='';
                    for(var i=0;i<data[0].length;i++){
                        content_html+=data[0][i];
                    }
                    tab('content').innerHTML=content_html;
                }
            })
        }
        //课程管理页面跳转
        tab('htguanli').onclick=function(){
            if(localStorage.getItem('user_name')==null&&localStorage.getItem('user_pass_word')==null){
                alert('请先登录');
                login_btn()
            }else{
                window.open('add.html')
            }
        }
    </script>
</body>
</html>